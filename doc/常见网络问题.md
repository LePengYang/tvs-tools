## 1 物灵使用SDK调用wup接口不通
### 1.1 问题背景
- 使用君正T20芯片，mips平台。
### 1.2 表现形式
- 终端访问 http://wup.dobby.qq.com:8080 TVS的WupProxy服务域名时，每次都不能完成TCP握手。**第三步本该是终端发送ACK给服务端，但终端发送的是RST，主动断开了连接。**
### 1.3 问题原因
- linux平台的SDK，在调用socket的connect后，会使用**“if（ret < 0 && errno != EINPROGRESS）”**判断connect是否成功。
- T20平台上，connect成功时，ret = -1，errno为EINPROGRESS。
- 在connect结束后，立即打印errno，值为EINPROGRESS；但在上面的if语句后面打印时时，errno值变为-2。说明中间有**其它系统调用修改了errno的值**。
### 1.4 解决方法
- 修改SDK的实现，不使用errno判断connect是否成功。

## 2 有屏音箱单台机器无法访问TVS后台域名
### 2.1 问题背景
- TVS API接入方式
### 2.2 表现形式
- 该机器之前运行良好，重新刷一个ROM版本后，无法访问TVS后台域名 “https://tvs.html5.qq.com”。
### 2.3 问题原因
- 刷机之后，机器的系统时间变成了**“2018.1.1”**。
- “https://tvs.html5.qq.com“ 使用了“\*.html5.qq.com”证书。该证书的有效期为“2018.3.8 - 2019.3.9”。
- 终端会验证证书的有效性，**终端本地时间戳不在证书的有效期内**，因此在SSL握手过程中失败。
### 2.4 解决方法
- 修改终端的时钟，调整为当前时间。

## 3 哈曼音箱使用SDK调用wup接口不通
### 3.1 问题背景
- SDK接入方式。
- Linux平台。
### 3.2 表现形式
- 终端访问 http://wup.dobby.qq.com:8080 TVS的WupProxy服务域名时，请求不到数据。SDK返回网络连接失败。
### 3.3 问题原因
- 终端本地时间是“**1970.1.1**”开始的开机时间。
- TCP握手请求携带了tsval参数。
- Wup接入层tgw不响应tsval参数。
- 终端与后台的时间戳存在冲突。
### 3.4 解决方法
- 修改终端的时钟，调整为当前时间。

## 4 君正音箱网络访问慢
### 4.1 问题背景
- SDK接入方式。
- Android平台。
### 4.2 表现形式
- 之前是好的。一段时间不用后，再用起来，语音识别后台无返回。
- 后台抓包发现有些请求包没有收到。
- 终端抓包发现，有严重的重传现象。
- 连接同一网络，PC ping后台地址要比设备ping后台地址快很多。
- 有时在三次握手时就重传，有时在ASR的过程中重传。
- 终端发送的包，有时5S才收到后台的回包。
### 4.3 问题原因
- 终端发包重传，是由于网络太差。
- 网络太差，是由于没有装天线。
### 4.4 解决方法
- 终端装上天线，网络恢复。