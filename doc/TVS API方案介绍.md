# 云端API方案介绍
# 概述
腾讯语音服务（TVS）云端API，是一套基于HTTP的Web接口。它接收用户的语音或文本输入，传递给腾讯叮当后台进行处理，并将处理结果以语音、文本或卡片的形式，返回给用户。

终端开发者申请开发者帐号后，就能通过TVS云端API接入腾讯叮当体系。使终端设备拥有腾讯叮当提供的新闻、音乐、天气、股票、闹钟等近百种能力。这些能力集，还会随着腾讯技能套件（TSK）体系而不断地增加和完善。

TVS API由一系列与终端功能相关的接口组成，包括语音识别、播放控制、音量控制等等。每个接口又包含的有一系列的指令（directives）和事件（events）集。指令是由腾讯叮当后台发送给终端的消息，指示终端执行具体的动作。事件是从终端发送给腾讯叮当后台的消息，用于通知腾讯叮当发生了什么事情。

TVS使用基于QQ互联、微信开放平台的腾讯叮当帐号体系进行产品授权，使用HTTP2.0协议对外提供服务。

# 主要功能
TVS云端API定义了八个主要接口，这些接口又各自包含了一系列的指令和事件集合，对应相应的终端能力。接口名称及简要说明如下：

|接口|描述|
|-----|------|
|SpeechRecognizer|语音识别。TVS的核心接口，每次会话都要用到Recognize事件。|
|SpeechSynthesizer|语音朗读。Dingdang语音接口。|
|Alerts|设置、停止、删除定时器和闹钟的接口。|
|AudioPlayer|用于管理和控制音频播放。|
|PlaybackController|用于通过按键控制播放的接口。|
|Speeker|扬声器接口。设备或App的音量控制接口，包括静音和取消静音。|
|Settings|管理Dingdang设置的接口，如环境相关的设置。|
|System|为Dingdang提供终端信息的接口。|
# 技术特色
腾讯语音服务（TVS）云端API，是一套基于HTTP的Web接口。它接收用户的语音或文本输入，传递给腾讯叮当后台进行处理，并将处理结果以语音、文本或卡片的形式，返回给用户。

## 语法兼容AVS API
TVS云端API的接口定义、通信协议完全兼容AVS API。已经接入过AVS的设备厂商，只需将AVS API的服务端地址指向TVS云端API的服务端地址，即可将产品快速切换到腾讯叮当体系，不需要调整终端的其它逻辑实现。

##输入兼容文本和语音
TVS云端API在支持语音输入的同时，扩展支持文本的输入。允许终端厂商定制选择语音识别方案商，提供更多的集成灵活性。 目前只支持UTF8编码格式的中文文本输入。

## 输出兼容有屏和无屏端
TVS云端API提供语音、文本和模板三类输出格式。 
对于音箱、耳机等无屏设备，终端开发者只需要支持语音、媒体URL格式数据的播放。 
对于车机、手机等有屏设备，TVS云端提供与语音输出对应的文本输出；同时提供多套模板，定义模板对应的数据结构及样式，方便终端实现更丰富的展示效果。

## 唤醒词集成腾讯、讯飞、sensory等主流解决方案
TVS云端API解决方案，已完成腾讯、讯飞、sensory等国内外多家唤醒词方案商。并以终端SDK的方式提供主流平台的集成调用。已使用过讯飞、sensory等厂家唤醒词的项目，可以不用调整已有声学前端，即可完成唤醒词的替换。

## 扩展支持机器人动作和情感控制指令
TVS云端API针对机器人领域，扩展了控制指令集。支持如跳舞、打太极、俯卧撑等多种动作，及开心、兴奋、悲伤等多种情感控制指令，并将动作、情感指令合并在天气、新闻等业务场景中下发。

# 接入流程
## 帐号登录
终端访问TVS云端API，需要先获取腾讯叮当帐号体系的访问票据。该票据授权终端设备代表用户，向腾讯叮当发起调用。 
基于Android或iOS厂商App方式进行帐号认证的产品接入流程，请参考： 
[腾讯叮当厂商App账号接入流程](https://softfile.3g.qq.com/myapp/trom_l/dingdang/gw/files/cloud_sdk/tvs_access.pdf)

## 服务地址
- TVS指令下发地址：<https://tvs.html5.qq.com/v20160207/directives/> 
- TVS事件接收地址：<https://tvs.html5.qq.com/v20160207/events/> 
- TVS Ping地址：<https://tvs.html5.qq.com/ping/>

## API文档
TVS API各接口的详细说明，请参考：
[TVS API接口文档](https://github.com/TencentDingdang/tvs-tools/blob/master/doc/Tencent%20Voice%20Service%20Reference.md)